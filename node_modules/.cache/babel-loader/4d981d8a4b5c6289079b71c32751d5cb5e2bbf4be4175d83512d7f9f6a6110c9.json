{"ast":null,"code":"import _defineProperty from\"C:/Users/Slim Romdane/Desktop/VirtualimmoVF-main/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/Slim Romdane/Desktop/VirtualimmoVF-main/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/Slim Romdane/Desktop/VirtualimmoVF-main/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import moment from\"moment\";import{useEffect,useState}from\"react\";import{Redirect}from\"react-router-dom\";import{BigCalendar}from\"react-big-calendar\";import axios from\"axios\";import\"../assets/css/Appointment.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Appointment(props){var _useState=useState({date:null,customer:\"\",agent:\"\",time:null,reason:\"\"// add this\n}),_useState2=_slicedToArray(_useState,2),visit=_useState2[0],setVisit=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),agentOptions=_useState4[0],setAgentOptions=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];useEffect(function(){var token=localStorage.getItem(\"token\");if(token){axios.post(\"http://localhost:3002/users/verify\",{token:token}).then(function(_ref){var data=_ref.data;props.setUser(data);setIsLoading(false);return data;}).then(function(user){axios.get(\"http://localhost:3002/users\").then(function(_ref2){var data=_ref2.data;var agents=data.filter(function(elem){return elem.role===\"Agent\";});setAgentOptions(agents);setVisit(_objectSpread(_objectSpread({},visit),{},{agent:agents[0]._id,customer:user._id}));}).catch(function(error){console.log(error);});}).catch(function(error){console.log(error);setIsLoading(false);});}else{setIsLoading(false);}},[]);if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:\"Loading...\"});}if(!props.user.name){return/*#__PURE__*/_jsx(Redirect,{to:\"/login\"});}var handleChange=function handleChange(e){setVisit(_objectSpread(_objectSpread({},visit),{},_defineProperty({},e.target.id,e.target.value)));};var handleTimeChange=function handleTimeChange(e){var startTime=moment(e.target.value,\"HH:mm\").format();setVisit(_objectSpread(_objectSpread({},visit),{},{time:startTime}));};var handleNotesChange=function handleNotesChange(e){setVisit(_objectSpread(_objectSpread({},visit),{},{notes:e.target.value}));};var createAppointment=function createAppointment(){axios.post(\"http://localhost:3002/visits\",visit).then(function(){console.log(\"created\");}).catch(function(error){console.log(error);});};return/*#__PURE__*/_jsxs(\"div\",{className:\"appointment-page\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"background-image\",src:require(\"../assets/img/backgroundimage.jpg\"),alt:\"Virtual Tour\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"container-form\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"h3\",{children:[\"Bonjour \",props.user.name,\" \",props.user.surname,\", veuillez prendre un rendez-vous\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card card-plain\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-groupe\",children:/*#__PURE__*/_jsx(\"input\",{id:\"date\",onChange:handleChange,type:\"date\",placeholder:\"Enter Appointment date\",className:\"form-control\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-groupe\",children:/*#__PURE__*/_jsx(\"input\",{id:\"time\",onChange:handleTimeChange,type:\"time\",min:\"08:00\",max:\"18:00\",placeholder:\"Enter Appointment time\",className:\"form-control\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-groupe\",children:/*#__PURE__*/_jsxs(\"select\",{onChange:handleChange,id:\"agent\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"Select an option\",disabled:true,children:\"Select an agent\"}),agentOptions.map(function(value,index){return/*#__PURE__*/_jsxs(\"option\",{value:value._id,children:[value.name,\" \",value.surname]},index);})]})}),/*#__PURE__*/_jsx(\"textarea\",{onChange:handleNotesChange,placeholder:\"What would you like to discuss during the appointment?\",className:\"form-control\",id:\"notes\",style:{width:\"300%\",alignContent:\"center\",height:\"300%\"}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"footer text-center\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",onClick:function onClick(){createAppointment();alert(\"Your appointment has been booked!\");},className:\"btn btn-fill btn-neutral btn-wd\",style:{alignContent:\"center\",height:\"100%\",backgroundColor:\"black\"},children:\"Prendre rendez-vous\"})})]})})})]})]});}export default Appointment;","map":{"version":3,"names":["moment","useEffect","useState","Redirect","BigCalendar","axios","Appointment","props","date","customer","agent","time","reason","visit","setVisit","agentOptions","setAgentOptions","isLoading","setIsLoading","token","localStorage","getItem","post","then","data","setUser","user","get","agents","filter","elem","role","_id","catch","error","console","log","name","handleChange","e","target","id","value","handleTimeChange","startTime","format","handleNotesChange","notes","createAppointment","require","surname","map","index","width","alignContent","height","alert","backgroundColor"],"sources":["C:/Users/Slim Romdane/Desktop/VirtualimmoVF-main/frontend/src/pages/Appointment.js"],"sourcesContent":["import moment from \"moment\";\nimport { useEffect, useState } from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport { BigCalendar } from \"react-big-calendar\";\nimport axios from \"axios\";\nimport \"../assets/css/Appointment.css\";\n\nfunction Appointment(props) {\n  const [visit, setVisit] = useState({\n    date: null,\n    customer: \"\",\n    agent: \"\",\n    time: null,\n    reason: \"\", // add this\n  });\n\n  const [agentOptions, setAgentOptions] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      axios\n        .post(\"http://localhost:3002/users/verify\", { token })\n        .then(({ data }) => {\n          props.setUser(data);\n          setIsLoading(false);\n          return data;\n        })\n        .then((user) => {\n          axios\n            .get(\"http://localhost:3002/users\")\n            .then(({ data }) => {\n              const agents = data.filter((elem) => elem.role === \"Agent\");\n              setAgentOptions(agents);\n              setVisit({\n                ...visit,\n                agent: agents[0]._id,\n                customer: user._id,\n              });\n            })\n            .catch((error) => {\n              console.log(error);\n            });\n        })\n        .catch((error) => {\n          console.log(error);\n          setIsLoading(false);\n        });\n    } else {\n      setIsLoading(false);\n    }\n  }, []);\n\n  if (isLoading) {\n    return <div className=\"App\">Loading...</div>;\n  }\n  if (!props.user.name) {\n    return <Redirect to=\"/login\" />;\n  }\n\n  const handleChange = (e) => {\n    setVisit({ ...visit, [e.target.id]: e.target.value });\n  };\n\n  const handleTimeChange = (e) => {\n    let startTime = moment(e.target.value, \"HH:mm\").format();\n    setVisit({ ...visit, time: startTime });\n  };\n\n  const handleNotesChange = (e) => {\n    setVisit({ ...visit, notes: e.target.value });\n  };\n\n  const createAppointment = () => {\n    axios\n      .post(\"http://localhost:3002/visits\", visit)\n      .then(() => {\n        console.log(\"created\");\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n  };\n  return (\n    <div className=\"appointment-page\">\n      <img\n        className=\"background-image\"\n        src={require(\"../assets/img/backgroundimage.jpg\")}\n        alt=\"Virtual Tour\"\n      />\n      <div className=\"container-form\">\n        <div className=\"row\">\n          <h3>\n            Bonjour {props.user.name} {props.user.surname}, veuillez prendre un\n            rendez-vous\n          </h3>\n        </div>\n        <div className=\"row\">\n          <div>\n            <div className=\"content\">\n              <div className=\"card card-plain\">\n                <div className=\"form-groupe\">\n                  <input\n                    id=\"date\"\n                    onChange={handleChange}\n                    type=\"date\"\n                    placeholder=\"Enter Appointment date\"\n                    className=\"form-control\"\n                  />\n                </div>\n                <div className=\"form-groupe\">\n                  <input\n                    id=\"time\"\n                    onChange={handleTimeChange}\n                    type=\"time\"\n                    min=\"08:00\"\n                    max=\"18:00\"\n                    placeholder=\"Enter Appointment time\"\n                    className=\"form-control\"\n                  />\n                </div>\n                <div className=\"form-groupe\">\n                  <select onChange={handleChange} id=\"agent\">\n                    <option value=\"Select an option\" disabled>\n                      Select an agent\n                    </option>\n                    {agentOptions.map((value, index) => (\n                      <option value={value._id} key={index}>\n                        {value.name} {value.surname}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n                <textarea\n                  onChange={handleNotesChange}\n                  placeholder=\"What would you like to discuss during the appointment?\"\n                  className=\"form-control\"\n                  id=\"notes\"\n                  style={{\n                    width: \"300%\",\n                    alignContent: \"center\",\n                    height: \"300%\",\n                  }}\n                ></textarea>\n              </div>\n              <div className=\"footer text-center\">\n                <button\n                  type=\"submit\"\n                  onClick={() => {\n                    createAppointment();\n                    alert(\"Your appointment has been booked!\");\n                  }}\n                  className=\"btn btn-fill btn-neutral btn-wd\"\n                  style={{\n                    alignContent: \"center\",\n                    height: \"100%\",\n                    backgroundColor: \"black\",\n                  }}\n                >\n                  Prendre rendez-vous\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Appointment;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}