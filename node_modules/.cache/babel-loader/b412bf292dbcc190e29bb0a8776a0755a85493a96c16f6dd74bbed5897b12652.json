{"ast":null,"code":"import _slicedToArray from\"C:/Users/Slim Romdane/Desktop/VirtualimmoVF-main/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";import axios from\"axios\";import{Redirect}from\"react-router-dom\";import\"../assets/css/Appointment.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function AppointmentList(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),visits=_useState2[0],setVisits=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];useEffect(function(){var token=localStorage.getItem(\"token\");if(token){axios.post(\"http://localhost:3002/users/verify\",{token:token}).then(function(_ref){var data=_ref.data;props.setUser(data);setIsLoading(false);return data;}).then(function(user){axios.get(\"http://localhost:3002/visits\").then(function(_ref2){var data=_ref2.data;if(user.role===\"Admin\"){setVisits(data);}else if(user.role===\"Customer\"){setVisits(data.filter(function(elem){return elem.customer._id===user._id;}));}else{setVisits(data.filter(function(elem){return elem.agent._id===user._id;}));}}).catch(function(error){console.log(error);});}).catch(function(error){console.log(error);setIsLoading(false);});}else{setIsLoading(false);}},[]);if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:\"Loading...\"});}if(!props.user.name){return/*#__PURE__*/_jsx(Redirect,{to:\"/login\"});}return/*#__PURE__*/_jsx(\"div\",{className:\"appointment-page\",children:/*#__PURE__*/_jsx(\"div\",{className:\"content\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container-fluid\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"h3\",{children:[\"Hello \",props.user.name,\" \",props.user.surname]})}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"content\",children:/*#__PURE__*/_jsxs(\"table\",{class:\"table table-hover table-striped\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Visit Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Customer\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Agent\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:visits.map(function(visit,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:visit.date}),/*#__PURE__*/_jsxs(\"td\",{children:[visit.customer.name,\" \",visit.customer.surname]}),/*#__PURE__*/_jsxs(\"td\",{children:[visit.agent.name,\" \",visit.agent.surname]})]},index);})})]})})})})]})})});}export default AppointmentList;","map":{"version":3,"names":["useState","useEffect","axios","Redirect","AppointmentList","props","visits","setVisits","isLoading","setIsLoading","token","localStorage","getItem","post","then","data","setUser","user","get","role","filter","elem","customer","_id","agent","catch","error","console","log","name","surname","map","visit","index","date"],"sources":["C:/Users/Slim Romdane/Desktop/VirtualimmoVF-main/frontend/src/pages/AppointmentList.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { Redirect } from \"react-router-dom\";\nimport \"../assets/css/Appointment.css\";\n\nfunction AppointmentList(props) {\n  const [visits, setVisits] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      axios\n        .post(\"http://localhost:3002/users/verify\", { token })\n        .then(({ data }) => {\n          props.setUser(data);\n          setIsLoading(false);\n          return data;\n        })\n        .then((user) => {\n          axios\n            .get(\"http://localhost:3002/visits\")\n            .then(({ data }) => {\n              if (user.role === \"Admin\") {\n                setVisits(data);\n              } else if (user.role === \"Customer\") {\n                setVisits(\n                  data.filter((elem) => elem.customer._id === user._id)\n                );\n              } else {\n                setVisits(data.filter((elem) => elem.agent._id === user._id));\n              }\n            })\n            .catch((error) => {\n              console.log(error);\n            });\n        })\n        .catch((error) => {\n          console.log(error);\n          setIsLoading(false);\n        });\n    } else {\n      setIsLoading(false);\n    }\n  }, []);\n  if (isLoading) {\n    return <div className=\"App\">Loading...</div>;\n  }\n  if (!props.user.name) {\n    return <Redirect to=\"/login\" />;\n  }\n\n  return (\n    <div className=\"appointment-page\">\n    <div className=\"content\">\n      <div className=\"container-fluid\">\n        <div className=\"row\">\n          <h3>\n            Hello {props.user.name} {props.user.surname}\n          </h3>\n        </div>\n        <div className=\"row\">\n          <div>\n            <div className=\"content\">\n              <table class=\"table table-hover table-striped\">\n                <thead>\n                  <tr>\n                    <th>Visit Date</th>\n                    <th>Customer</th>\n                    <th>Agent</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {visits.map((visit, index) => (\n                    <tr key={index}>\n                      <td>{visit.date}</td>\n                      <td>\n                        {visit.customer.name} {visit.customer.surname}\n                      </td>\n                      <td>\n                        {visit.agent.name} {visit.agent.surname}\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    </div>\n  );\n}\n\nexport default AppointmentList;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}